



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.pi-hole.net/ftldns/regex/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>RegEx blocking - Pi-hole documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#how-to-use-regular-expressions-for-blocking" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.pi-hole.net" title="Pi-hole documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Pi-hole documentation
              </span>
              <span class="md-header-nav__topic">
                RegEx blocking
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Pi-hole documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview & Support" class="md-nav__link">
      Overview & Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/prerequesites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/basic-install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/post-install/" title="Post-Install" class="md-nav__link">
      Post-Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/update/" title="Updating" class="md-nav__link">
      Updating
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      FTLDNS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        FTLDNS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configfile/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dns-resolver/" title="DNS resolver" class="md-nav__link">
      DNS resolver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blockingmode/" title="Blocking mode" class="md-nav__link">
      Blocking mode
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        RegEx blocking
      </label>
    
    <a href="./" title="RegEx blocking" class="md-nav__link md-nav__link--active">
      RegEx blocking
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-use-regular-expressions-for-blocking" title="How to use regular expressions for blocking" class="md-nav__link">
    How to use regular expressions for blocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pi-hole-regular-expressions-tutorial" title="Pi-hole regular expressions tutorial" class="md-nav__link">
    Pi-hole regular expressions tutorial
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anchors-and" title="Anchors (^ and $)" class="md-nav__link">
    Anchors (^ and $)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard" title="Wildcard (.)" class="md-nav__link">
    Wildcard (.)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-and-multipliers-and" title="Bounds and multipliers ({}, *, +, and ?)" class="md-nav__link">
    Bounds and multipliers ({}, *, +, and ?)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-groups" title="Character groups ([])" class="md-nav__link">
    Character groups ([])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groups" title="Groups (())" class="md-nav__link">
    Groups (())
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternations" title="Alternations (|)" class="md-nav__link">
    Alternations (|)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-classes-class" title="Character classes ([:class:])" class="md-nav__link">
    Character classes ([:class:])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-examples" title="Advanced examples" class="md-nav__link">
    Advanced examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-domain-with-only-numbers" title="Block domain with only numbers" class="md-nav__link">
    Block domain with only numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-domains-without-subdomains" title="Block domains without subdomains" class="md-nav__link">
    Block domains without subdomains
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cheatsheet" title="Cheatsheet" class="md-nav__link">
    Cheatsheet
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../privacylevels/" title="Privacy levels" class="md-nav__link">
      Privacy levels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../database/" title="Long-term database" class="md-nav__link">
      Long-term database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../telnet-api/" title="Telnet API" class="md-nav__link">
      Telnet API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compile/" title="Install from source" class="md-nav__link">
      Install from source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../debugging/" title="Debugging FTLDNS" class="md-nav__link">
      Debugging FTLDNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../in-depth/" title="In-depth manual" class="md-nav__link">
      In-depth manual
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/unbound/" title="Pi-hole as All-Around DNS Solution" class="md-nav__link">
      Pi-hole as All-Around DNS Solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Pi-hole and OpenVPN Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Pi-hole and OpenVPN Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/setup-openvpn-server/" title="Setup OpenVPN Server" class="md-nav__link">
      Setup OpenVPN Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/firewall/" title="Firewall Configuration" class="md-nav__link">
      Firewall Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-5" type="checkbox" id="nav-4-2-5">
    
    <label class="md-nav__link" for="nav-4-2-5">
      Connecting clients
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-5">
        Connecting clients
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/clients/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/android-client/" title="Android" class="md-nav__link">
      Android
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/only-dns-via-vpn/" title="Optional: Only route DNS via VPN" class="md-nav__link">
      Optional: Only route DNS via VPN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/dual-operation/" title="Optional: Dual operation: LAN & VPN at the same time" class="md-nav__link">
      Optional: Dual operation: LAN & VPN at the same time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/dynDNS/" title="Optional: Dynamic DNS" class="md-nav__link">
      Optional: Dynamic DNS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-use-regular-expressions-for-blocking" title="How to use regular expressions for blocking" class="md-nav__link">
    How to use regular expressions for blocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pi-hole-regular-expressions-tutorial" title="Pi-hole regular expressions tutorial" class="md-nav__link">
    Pi-hole regular expressions tutorial
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anchors-and" title="Anchors (^ and $)" class="md-nav__link">
    Anchors (^ and $)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard" title="Wildcard (.)" class="md-nav__link">
    Wildcard (.)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounds-and-multipliers-and" title="Bounds and multipliers ({}, *, +, and ?)" class="md-nav__link">
    Bounds and multipliers ({}, *, +, and ?)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-groups" title="Character groups ([])" class="md-nav__link">
    Character groups ([])
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groups" title="Groups (())" class="md-nav__link">
    Groups (())
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternations" title="Alternations (|)" class="md-nav__link">
    Alternations (|)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-classes-class" title="Character classes ([:class:])" class="md-nav__link">
    Character classes ([:class:])
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-examples" title="Advanced examples" class="md-nav__link">
    Advanced examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-domain-with-only-numbers" title="Block domain with only numbers" class="md-nav__link">
    Block domain with only numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-domains-without-subdomains" title="Block domains without subdomains" class="md-nav__link">
    Block domains without subdomains
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cheatsheet" title="Cheatsheet" class="md-nav__link">
    Cheatsheet
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>RegEx blocking</h1>
                
                <p>A regular expression, or <abbr title="Regular expression">RegEx</abbr> for short, is a pattern that can be used for building arbitrarily complex blocking rules in <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr>.
We implement the <abbr title="Extended Regular Expressions">ERE</abbr> flavor similar to the one used by the UNIX <code>egrep</code> (or <code>grep -E</code>) command.</p>
<p>Our implementation is computationally inexpensive as each domain is only checked once for a match (if you query <code>google.com</code>, it will be checked against your <abbr title="Regular expression">RegEx</abbr>. Any subsequent query to the same domain will not be checked again until you restart <code>pihole-FTL</code>).</p>
<h2 id="how-to-use-regular-expressions-for-blocking">How to use regular expressions for blocking<a class="headerlink" href="#how-to-use-regular-expressions-for-blocking" title="Permanent link">&para;</a></h2>
<p>Add a line
<div class="codehilite"><pre><span></span>BLOCKINGREGEX=^abc$
</pre></div>
in your <code>/etc/pihole/pihole-FTL.conf</code> and restart <code>pihole-FTL</code>. <strong>Note: this is subject to change (we plan to support a list of regular expressions for blocking in the near future).</strong></p>
<h2 id="pi-hole-regular-expressions-tutorial">Pi-hole regular expressions tutorial<a class="headerlink" href="#pi-hole-regular-expressions-tutorial" title="Permanent link">&para;</a></h2>
<p>We provide a short but thorough introduction to our regular expressions implementation. This may come in handy if you are designing blocking rules (see also our cheat sheet below!). In our implementation, all characters match themselves except for the following special characters: <code>.[{}()\*+?|^$</code>. If you want to match those, you need to escape them like <code>\.</code> for a literal period, but no rule without exception (see character groups below for further details).</p>
<h3 id="anchors-and">Anchors (<code>^</code> and <code>$</code>)<a class="headerlink" href="#anchors-and" title="Permanent link">&para;</a></h3>
<p>First of all, we look at anchors which can be used to indicate the start or the end of a domain, respectively. If you don't specify anchors, the match may be partial (see examples below).</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>domain</code></td>
<td><strong>partial match</strong>. Without anchors, a text may appear anywhere in the domain. This matches <code>some.domain.com</code>, <code>domain.com</code> and <code>verylongdomain.com</code> and more</td>
</tr>
<tr>
<td><code>^localhost$</code></td>
<td><strong>exact match</strong> matching <em>only</em> <code>localhost</code> but neither <code>a.localhost</code> nor <code>localhost.com</code></td>
</tr>
<tr>
<td><code>^abc</code></td>
<td>matches any domain <strong>starting</strong> (<code>^</code>) in "abc" like <code>abcdomain.com</code>, <code>abc.domain.com</code> but not <code>def.abc.com</code></td>
</tr>
<tr>
<td><code>com$</code></td>
<td>matches any domain <strong>ending</strong> (<code>$</code>) in "com" such as <code>domain.com</code> but not <code>domain.com.co.uk</code></td>
</tr>
</tbody>
</table>
<h3 id="wildcard">Wildcard (<code>.</code>)<a class="headerlink" href="#wildcard" title="Permanent link">&para;</a></h3>
<p>An unescaped period stands for any <em>single</em> character.</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^domain.$</code></td>
<td>matches <code>domaina</code>, <code>domainb</code>, <code>domainc</code>, but not <code>domain</code></td>
</tr>
</tbody>
</table>
<h3 id="bounds-and-multipliers-and">Bounds and multipliers (<code>{}</code>, <code>*</code>, <code>+</code>, and <code>?</code>)<a class="headerlink" href="#bounds-and-multipliers-and" title="Permanent link">&para;</a></h3>
<p>With bounds, one can denote the number of times something has to occur:</p>
<table>
<thead>
<tr>
<th>Bound</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ab{4}</code></td>
<td>matches a domain that contains a single <code>a</code> followed by four <code>b</code> (matching only <code>abbbb</code>)</td>
</tr>
<tr>
<td><code>ab{4,}</code></td>
<td>matches a domain that contains a single <code>a</code> followed by <em>at least</em> four <code>b</code> (matching also <code>abbbbbbbb</code>)</td>
</tr>
<tr>
<td><code>ab{3,5}</code></td>
<td>matches a domain that contains a single <code>a</code> followed by three to five <code>b</code> (matching only <code>abbb</code>, <code>abbbb</code>, and <code>abbbbb</code>)</td>
</tr>
</tbody>
</table>
<p>Multipliers are shortcuts for some of the bounds that are needed most often:</p>
<table>
<thead>
<tr>
<th>Multipliers</th>
<th>Bounds equivalent</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>?</code></td>
<td><code>{0,1}</code></td>
<td>never or once (optional)</td>
</tr>
<tr>
<td><code>*</code></td>
<td><code>{0,}</code></td>
<td>never or more (optional)</td>
</tr>
<tr>
<td><code>+</code></td>
<td><code>{1,}</code></td>
<td>once or more (mandatory)</td>
</tr>
</tbody>
</table>
<p>To illustrate the usefulness of multipliers (and bounds), we provide a few examples:</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^r-*\.movie</code></td>
<td>matches a domain like <code>r------movie.com</code> where the number of dashes can be arbitrary (also none)</td>
</tr>
<tr>
<td><code>^r-?\.movie</code></td>
<td>matches only the domains <code>rmovie.com</code> and <code>r-movie.com</code> but not those with more than one dash</td>
</tr>
<tr>
<td><code>^r-+\.movie</code></td>
<td>matches only the domains with at least one dash, i.e., not <code>rmovie.com</code></td>
</tr>
<tr>
<td><code>^a?b+</code></td>
<td>matches domains like <code>abbbb.com</code> (zero or one <code>a</code> at the beginning followed by one or more <code>b</code>)</td>
</tr>
</tbody>
</table>
<h3 id="character-groups">Character groups (<code>[]</code>)<a class="headerlink" href="#character-groups" title="Permanent link">&para;</a></h3>
<p>With character groups, a set of characters can be matched:</p>
<table>
<thead>
<tr>
<th>Character group</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[abc]</code></td>
<td>matches <code>a</code>, <code>b</code>, or <code>c</code> (using explicitly specified characters)</td>
</tr>
<tr>
<td><code>[a-c]</code></td>
<td>matches <code>a</code>, <code>b</code>, or <code>c</code> (using a <em>range</em>)</td>
</tr>
<tr>
<td><code>[a-c]+</code></td>
<td>matches any non-zero number of <code>a</code>, <code>b</code>, <code>c</code></td>
</tr>
<tr>
<td><code>[a-z]</code></td>
<td>matches any single lowercase letter</td>
</tr>
<tr>
<td><code>[a-zA-Z]</code></td>
<td>matches any single letter</td>
</tr>
<tr>
<td><code>[a-z0-9]</code></td>
<td>matches any single lowercase letter or any single digit</td>
</tr>
<tr>
<td><code>[^a-z]</code></td>
<td><strong>Negation</strong> matching any single character <em>except</em> lowercase letters</td>
</tr>
<tr>
<td><code>abc[0-9]+</code></td>
<td>matches the string <code>abc</code> followed by a number of arbitrary length</td>
</tr>
</tbody>
</table>
<p>Bracket expressions are an exception to the character escape rule. Inside them, all special characters, including the backslash (<code>\</code>), lose their special powers, i.e. they match themselves exactly. Furthermore, to include a literal <code>]</code> in the list, make it the first character (like <code>[]]</code> or <code>[^]]</code> if negated). To include a literal <code>-</code>, make it the first or last character, or the second endpoint of a range (e.g. <code>[a-z-]</code> to match <code>a</code> to <code>z</code> and <code>-</code>).</p>
<h3 id="groups">Groups (<code>()</code>)<a class="headerlink" href="#groups" title="Permanent link">&para;</a></h3>
<p>Using groups, we can enclose regular expressions, they are most powerful when combined with bounds or multipliers (see also alternations below).</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(abc)</code></td>
<td>matches <code>abc</code> (trivial example)</td>
</tr>
<tr>
<td><code>(abc)*</code></td>
<td>matches zero or more copies of <code>abc</code> like <code>abcabc</code> but not <code>abcdefabc</code></td>
</tr>
<tr>
<td><code>(abc){1,3}</code></td>
<td>matches one, two or three copies of <code>abc</code>: <code>abc</code>, <code>abcabc</code>, <code>abcabcabc</code> but nothing else</td>
</tr>
</tbody>
</table>
<h3 id="alternations">Alternations (<code>|</code>)<a class="headerlink" href="#alternations" title="Permanent link">&para;</a></h3>
<p>Alternations can be used as an "or" operator in regular expressions.</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(abc)|(def)</code></td>
<td>matches <code>abc</code> <em>and</em> <code>def</code></td>
</tr>
<tr>
<td><code>domain(a|b)\.com</code></td>
<td>matches <code>domaina.com</code> and <code>domainb.com</code> but not <code>domain.com</code> or <code>domainx.com</code></td>
</tr>
<tr>
<td><code>domain(a|b)*\.com</code></td>
<td>matches <code>domain.com</code>, <code>domainaaaa.com</code> <code>domainbbb.com</code> but not <code>domainab.com</code> (any number of <code>a</code> or <code>b</code> in between <code>domain</code> and <code>.com</code>)</td>
</tr>
</tbody>
</table>
<h3 id="character-classes-class">Character classes (<code>[:class:]</code>)<a class="headerlink" href="#character-classes-class" title="Permanent link">&para;</a></h3>
<p>In addition to character groups, there are also some special character classes available, such as</p>
<table>
<thead>
<tr>
<th>Character class</th>
<th>Group equivalent</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[:digit:]</code></td>
<td><code>[0-9]</code></td>
<td>matches digits</td>
</tr>
<tr>
<td><code>[:lower:]</code></td>
<td><code>[a-z]</code></td>
<td>matched lowercase letters</td>
</tr>
<tr>
<td><code>[:upper:]</code></td>
<td><code>[A-Z]</code></td>
<td>matched uppercase letters</td>
</tr>
<tr>
<td><code>[:alpha:]</code></td>
<td><code>[A-Za-z]</code></td>
<td>matches alphabetic characters</td>
</tr>
<tr>
<td><code>[:alnum:]</code></td>
<td><code>[A-Za-z0-9]</code></td>
<td>matches alphabetic characters and digits</td>
</tr>
</tbody>
</table>
<h2 id="advanced-examples">Advanced examples<a class="headerlink" href="#advanced-examples" title="Permanent link">&para;</a></h2>
<p>After going through our quick tutorial, we provide some more advances examples so you can test your knowledge.</p>
<h3 id="block-domain-with-only-numbers">Block domain with only numbers<a class="headerlink" href="#block-domain-with-only-numbers" title="Permanent link">&para;</a></h3>
<p><div class="codehilite"><pre><span></span>^[0-9][^a-z]+\.((com)|(edu))$
</pre></div>
Blocks domains containing only numbers (no letters) and ending in <code>.com</code> or <code>.edu</code>. Blocks <code>555661.com</code>, and <code>456.edu</code>, but not <code>555g555.com</code></p>
<h3 id="block-domains-without-subdomains">Block domains without subdomains<a class="headerlink" href="#block-domains-without-subdomains" title="Permanent link">&para;</a></h3>
<p><div class="codehilite"><pre><span></span>^[a-z0-9]+([\-]{1}[a-z0-9]+)*\.[a-z]{2,7}$
</pre></div>
A domain name shall not start or end with a dash but can contain any number of them. It must be followed by a <abbr title="Top-level domain (domains at the highest level in the hierarchical Domain Name System of the Internet., e.g. &quot;.com&quot;, &quot;.org&quot;, etc.)">TLD</abbr> (we assume a valid <abbr title="Top-level domain (domains at the highest level in the hierarchical Domain Name System of the Internet., e.g. &quot;.com&quot;, &quot;.org&quot;, etc.)">TLD</abbr> length of two to seven characters)</p>
<h2 id="cheatsheet">Cheatsheet<a class="headerlink" href="#cheatsheet" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Expression</th>
<th>Meaning</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^</code></td>
<td>Beginning of string</td>
<td><code>^client</code> matches strings that begin with <code>client</code>, such as <code>client.server.com</code> but not <code>more.client.server.com</code> (exception: within a character range (<code>[]</code>) <code>^</code> means negation)</td>
</tr>
<tr>
<td><code>$</code></td>
<td>End of string</td>
<td><code>ing$</code> matches <code>exciting</code> but not <code>ingenious</code></td>
</tr>
<tr>
<td><code>*</code></td>
<td>Match zero or more of the previous</td>
<td><code>ah*</code> matches <code>ahhhhh</code> or <code>a</code></td>
</tr>
<tr>
<td><code>?</code></td>
<td>Match zero or one of the previous</td>
<td><code>ah?</code> matches <code>a</code> or <code>ah</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td>Match one or more of the previous</td>
<td><code>ah+</code> matches <code>ah</code> or <code>ahhh</code> but not <code>a</code></td>
</tr>
<tr>
<td><code>.</code></td>
<td>Wildcard character, matches any character</td>
<td><code>do.*</code> matches <code>do</code>, <code>dog</code>, <code>door</code>, <code>dot</code>, etc.;<br><code>do.+</code> matches <code>dog</code>, <code>door</code>, <code>dot</code>, etc. but not <code>do</code> (wildcard with <code>+</code> requires at least one extra character for matching)</td>
</tr>
<tr>
<td><code>( )</code></td>
<td>Group</td>
<td>Enclose regular expressions, see the example for <code>|</code></td>
</tr>
<tr>
<td><code>|</code></td>
<td>Alternation</td>
<td><code>(mon|tues)day</code> matches <code>monday</code> or <code>tuesday</code> but not <code>friday</code> or <code>mondiag</code></td>
</tr>
<tr>
<td><code>[ ]</code></td>
<td>Matches a range of characters</td>
<td><code>[cbf]ar</code> matches <code>car</code>, <code>bar</code>, or <code>far</code>;</td>
</tr>
<tr>
<td><code>[^]</code></td>
<td>Negation</td>
<td><code>[^0-9]</code> matches any character <em>except</em> <code>0</code> to <code>9</code></td>
</tr>
<tr>
<td><code>{ }</code></td>
<td>Matches a specified number of occurrences of the previous</td>
<td><code>[0-9]{3}</code> matches any three-digit number like <code>315</code> but not <code>31</code>;<br><code>[0-9]{2,4}</code> matches two- to four-digit numbers like <code>12</code>, <code>123</code>, and <code>1234</code> but not <code>1</code> or <code>12345</code>;<br><code>[0-9]{2,}</code> matches any number with two or more digits like <code>1234567</code>, <code>123456789</code>, but not <code>1</code></td>
</tr>
<tr>
<td><code>\</code></td>
<td>Used to escape a special character not inside <code>[]</code></td>
<td><code>google\.com</code> matches <code>google.com</code></td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../blockingmode/" title="Blocking mode" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Blocking mode
              </span>
            </div>
          </a>
        
        
          <a href="../privacylevels/" title="Privacy levels" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Privacy levels
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Pi-hole LLC
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://pi-hole.net" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/pi-hole" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>